devtools::load_all()
loadFA("../sequences.fa")
devtools::load_all()
loadFA("../sequences.fa")
devtools::load_all()
loadFA("../sequences.fa")
devtools::load_all()
loadFA("../sequences.fa")
loadFA("../sequences.fa")
loadFA("../sequences.fa")
devtools::load_all()
loadFA("../sequences.fa")
tolower(">")
loadFA("../sequences.fa")
con <- file("../sequences.fa")
x <- 0
currSeq <- ""
currChr <- ""
while(TRUE){}
while(TRUE){
currline <- realines(con, n=1)
}
while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > fileSizeLimit) {}
}
while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > 1000000) {
break
}
}
while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > 1000000) {
break
}
print(currline)
}
while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > 1000000) {
break
}
print(currline)
}
fxn <- while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > 1000000) {
break
}
print(currline)
}
fxn <- while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > 1000000) {
break
}
print(currline)
}
}
fxn <- function(){while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > 1000000) {
break
}
print(currline)
}
}
fxn <- function(){while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > 1000000) {
break
}
print(currline)
}
}
fxn()
loadFA("../sequences.fa")
devtools::check()
loadFA("../sequences.fa")
loadFA("../sequences.fa")
devtools::load_all()
loadFA("../sequences.fa")
devtools::load_all()
devtools::check()
m <- loadFA("../sequences.fa")
m <- loadFA("../sequences.fa")
devtools::load_all()
m <- loadFA("../sequences.fa")
devtools::load_all()
m <- loadFA("../sequences.fa")
devtools::load_all()
m <- loadFA("../sequences.fa")
gc()
gc()
explorer()
explore()
explore <- View
explore()
explore(c)
devtools::load_all()
m <- loadFA("../sequences.fa")
j <- loadVCF("../ex01.vcf")
plotPosition(j)
ggplot(j@variantData, aes(x=pos)) + geom_histogram(bins=300, color = "orange", fill="orange", size=1) + facet_wrap(~ch)
j
sample(LETTERS, 10)
j@variantDATA$ch <- sample(LETTERS)
j@variantData$ch <- sample(LETTERS)
j@variantData
j <- loadVCF("../test01.vcf")
j
ggplot(j@variantData, aes(x=pos)) + geom_histogram(bins=300, color = "orange", fill="orange", size=1) + facet_wrap(~ch)
ggplot(j@variantData, aes(fill=ch, x=pos)) + geom_histogram(bins=300, size=1) + facet_wrap(~ch)
ggplot(j@variantData, aes(fill=ch, x=pos)) + geom_histogram(bins=300, size=1)
ggplot(j@variantData, aes(fill=ch, x=pos)) + geom_histogram(bins=300, size=1)
devtools
devtools::load_all("")
devtools::load_all()
j
devtools::load_all()
j <- loadVCF("../test01.vcf")
j <- loadVCF("../test01.vcf")
devtools::load_all()
j <- loadVCF("../test01.vcf")
devtools::load_all()
devtools::load_all()
j <- loadVCF("../test01.vcf")
j
j@variantData[ref_a == "T" && alt_a == "G"]
j@variantData[ref_a == "T" && alt_a == "C"]
data.table(iris)
mg <- data.table(iris)
rows(mg)
rownames(mg)
colnames(mg)
j@variantData[ref_a == "T"]
j@variantData[ref_a == "T"]
plotPosition(j)
1:10E08
m <- loadFA("../test01.fa")
m <- ""
nchar(m)
devtools::load_all()
m <- loadFA("../test01.fa")
gc()
currChr <- ""
currSeq <- ""
nchar(currChr)>0
nchar(currChr)>0 & nchar(currSeq)>0
devtools::load_all()
m <- loadFA("../test01.fa")
m <- loadFA("../test01.fa")
devtools::load_all()
m <- loadFA("../test01.fa")
devtools::load_all()
m <- loadFA("../test01.fa")
loadFA <- function(filepath, fileSizeLimit = 1000000){
faObject <- new("faObj")
con <- file(filepath, "r")
x <- 0
currSeq <- ""
currChr <- ""
while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > fileSizeLimit) {
#cleanup and loop exit
break
}
if(tolower(substr(currline, 1, 1)) == ">"){
#print(substr(currline, 1, 1))
# 1. Place any existing seq + chrName in the data frame
if((nchar(currChr) > 0) & (nchar(currSeq) > 0)){
newSeqDt <- data.table(chrName = currChr, seq = currSeq)
print(newSeqDt)
faObject@sequenceData <- rbindlist(
list(faObject@sequenceData, newSeqDt)
)
}
# 2. Grab new chrname
currSeq <- ""
currChr <- substr((strsplit(currChr, " ")[[1]][1]), 2, nchar(currChr))
} else {
currSeq <- paste0(currSeq, currline)
#print(paste("pasting: ", currline))
}
x <- x + 1
}
close(con)
return(faObject)
}
m <- loadFA("../test01.fa")
loadFA <- function(filepath, fileSizeLimit = 1000000){
faObject <- new("faObj")
con <- file(filepath, "r")
x <- 0
currSeq <- ""
currChr <- ""
while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > fileSizeLimit) {
#cleanup and loop exit
break
}
if(tolower(substr(currline, 1, 1)) == ">"){
#print(substr(currline, 1, 1))
# 1. Place any existing seq + chrName in the data frame
if((nchar(currChr) > 0) & (nchar(currSeq) > 0)){
newSeqDt <- data.table(chrName = currChr, seq = currSeq)
print(newSeqDt)
faObject@sequenceData <- rbindlist(
list(faObject@sequenceData, newSeqDt)
)
}
# 2. Grab new chrname
currSeq <- ""
currChr <- substr((strsplit(currChr, " ")[[1]][1]), 2, nchar(currChr))
} else {
currSeq <- paste0(currSeq, currline)
#print(paste("pasting: ", currline))
}
x <- x + 1
}
close(con)
return(faObject)
}
loadFA <- function(filepath, fileSizeLimit = 1000000){
faObject <- new("faObj")
con <- file(filepath, "r")
x <- 0
currSeq <- ""
currChr <- ""
while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > fileSizeLimit) {
#cleanup and loop exit
break
}
if(tolower(substr(currline, 1, 1)) == ">"){
#print(substr(currline, 1, 1))
# 1. Place any existing seq + chrName in the data frame
if((nchar(currChr) > 0) & (nchar(currSeq) > 0)){
newSeqDt <- data.table(chrName = currChr, seq = currSeq)
print(newSeqDt)
faObject@sequenceData <- rbindlist(
list(faObject@sequenceData, newSeqDt)
)
}
# 2. Grab new chrname
currSeq <- ""
currChr <- substr((strsplit(currChr, " ")[[1]][1]), 2, nchar(currChr))
} else {
currSeq <- paste0(currSeq, currline)
#print(paste("pasting: ", currline))
}
x <- x + 1
}
close(con)
return(faObject)
}
loadFA <- function(filepath, fileSizeLimit = 1000000){
faObject <- new("faObj")
con <- file(filepath, "r")
x <- 0
currSeq <- ""
currChr <- ""
while(TRUE){
currline <- readLines(con, n=1)
if(length(currline) == 0 || x > fileSizeLimit) {
#cleanup and loop exit
break
}
if(tolower(substr(currline, 1, 1)) == ">"){
#print(substr(currline, 1, 1))
# 1. Place any existing seq + chrName in the data frame
print(paste("currChr:", currChr, "currSeq:", currSeq))
if((nchar(currChr) > 0) & (nchar(currSeq) > 0)){
newSeqDt <- data.table(chrName = currChr, seq = currSeq)
print(newSeqDt)
faObject@sequenceData <- rbindlist(
list(faObject@sequenceData, newSeqDt)
)
}
# 2. Grab new chrname
currSeq <- ""
currChr <- substr((strsplit(currChr, " ")[[1]][1]), 2, nchar(currChr))
} else {
currSeq <- paste0(currSeq, currline)
#print(paste("pasting: ", currline))
}
x <- x + 1
}
close(con)
return(faObject)
}
m <- loadFA("../test01.fa")
devtools::load_all()
rm(list=c('loadFA'))
devtools::load_all()
m <- loadFA("../test01.fa")
devtools::load_all()
m <- loadFA("../test01.fa")
devtools::load_all()
m <- loadFA("../test01.fa")
devtools::load_all()
m <- loadFA("../test01.fa")
devtools::load_all()
m <- loadFA("../test01.fa")
m
m@sequenceData
q <- m@sequenceData
q
View(q)
devtools::load_all()
devtools::load_all()
m <- loadFA("../test01.fa")
q <- m@sequenceData
q
View(q)
m <- loadFA("../sequences.fa")
q
q()
help()
help.start()
library(seqinr)
read.fasta(file=system.file("../sequences.fa"))
read.fasta(file=system.file("../sequences.fa", "r"))
fafile <- system.file("../sequences.fa", package="seqinr")
dnaseq <- read.fasta(file = fafile, as.string = TRUE, seqtype = "DNA")[[1]]
getwd()
fafile <- system.file("../notafile.fa", package="seqinr")
dnaseq <- read.fasta(file = fafile, as.string = TRUE, seqtype = "DNA")[[1]]
fafile <- system.file("../test01.fa", package="seqinr")
dnaseq <- read.fasta(file = fafile, as.string = TRUE, seqtype = "DNA")[[1]]
dnafile <- system.file("../sequences.fa", package = "seqinr")
read.faste(file=dnafile)
read.fasta(file=dnafile)
devtools::load_all()
read.fasta(file=dnafile)
read.fasta(file=dnafile)
dnafile <- system.file(""D:\Documents\School\Acad\Year 4\BCB410\sequences.fa"", package = "seqinr")
dnafile <- system.file("D:\Documents\School\Acad\Year 4\BCB410\sequences.fa", package = "seqinr")
dnafile <- system.file("D:/Documents/School/Acad/Year 4/BCB410/sequences.fa", package = "seqinr")
read.fasta(file=dnafile)
m <- read.fasta(dnafile)[[1]]
library(readr)
??vcf
dnafile <- system.file("D:/Documents/School/Acad/Year 4/BCB410/sequences.fa")
library(seqinr)
m <- read.fasta("../sequences")
m <- read.fasta("../sequences.fa")
m <- read.fasta("../ex01.fa")
m <- read.fasta("../test01.fa")
m
m[1]
m[2]
m[3]
m[]
m[1]
attributes(m[1])
attributes(m)
attributes(m$1)
attributes(m$1)
m$1
m[1]
m1<-m[1]
m[[1]]
m[[1]]
mOne <- m[[1]]
mOne
attributes(mOne)
mOne
print(mOne)
mOne[4]
mOne[5]
mOne[6]
length(m)
m
m[[2]]
attributes(m[[2]], "name"
)
attributes(m[[2]], "name")
attr(m[[2]], "name")
?attr
toString(mOne)
mOne
paste(mOne)
paste(mOne, sep="")
toString(m)
gsub("\"", "", mOne)
mOneStr <- gsub("\"", "", mOne)
mOneStr <- toString(mOne)
mOneStr <- gsub(", ", "", mOneStr)
m <- read.fasta("../sequences.fa")
m
m[[1]]
toString(m)
toString(m[[1]])
j <- toString(m[[1]])
faObject <- new("faObj")
devtools::load_all()
devtools::load_all()
devtools::check()
gc()
rm(m)
rm(m1)
rm(*)
rm()
gc()
rm(j, mOne)
gc()
devtools::check()
devtools::check()
devtools::check()
rand::last_error
library(seqinr)
devtools::check()
`rland::last_error()`
`rlang::last_error()`
rlang::last_error
`grross with a space` <- "hello"
rm(`grross with a space`)
gc()
devtools::loaded_packages(e)
devtools::loaded_packages()
seqinr
library(seqinr)
usethis::use_package("seqinr")
usethis::use_package("ggplot2")
devtools::check()
seqinr
usethis::use_package("data.table", "ggplot2", "methods", "seqinr")
usethis::use_package("data.table", "ggplot2", "methods")
usethis::use_package("data.table")
usethis::use_package("ggplot2")
usethis::use_package("methods")
usethis::use_package("seqinr")
devtools::check()
loadVCF("../ex01.vcf")
b <- loadVCF("../ex01.vcf")
b$variantData
b@variantData$fakeCh <- sample(1:6, size = nrow(b@variantData), replace = TRUE)
fakechplot <- ggplot(j@variantData, aes(fill=fakech, x=pos))
fakechplot <- ggplot(b@variantData, aes(fill=fakech, x=pos))
plotPosition(b)
j <- b
plotPosition(b)
fakechplot + geom_histogram(bins = 300, size = 1)
fakechplot + geom_histogram(bins = 300, size = 1)
fakechplot
hello
fakechplot
b@variantData
fakechplot <- ggplot(b@variantData, aes(fill=fakeCh, x=pos))
fakechplot + geom_histogram(bins=300, size=1)
fakechplot <- ggplot(b@variantData, aes(fill=ch, x=pos))
fakechplot + geom_histogram(bins=300, size=1)
fakechplot <- ggplot(b@variantData, aes(fill=toString(fakeCh, x=pos))
)
fakechplot <- ggplot(b@variantData, aes(fill=toString(fakeCh), x=pos))
fakechplot + geom_histogram(bins=300, size=1)
toString(b@variantData$fakeCh)
b <- loadVCF("../ex01.vcf")
b@variantData$fakeCh <- sample(c("1", "2", "3", "4", "5", "6"), size = nrow(b@variantData), replace = TRUE)
fakechplot <- ggplot(b@variantData, aes(fill=toString(fakeCh), x=pos))
fakechplot + geom_histogram(bins=300, size=1)
fakechplot <- ggplot(b@variantData, aes(fill=fakeCh, x=pos))
fakechplot + geom_histogram(bins=300, size=1)
gc()
#it's just the ratio of A<->G + C<->T changes / the rest.
#literally could be written in 1 line i think?
ti <- vcfObj@variantdata[
ref_a == "" & alt_a == ""
ref_a == "" & alt_a == ""
ref_a == "" & alt_a == ""
ref_a == "" & alt_a == ""] #C'est une data.table with the info. I need to filter by rows.
j
ti <- j@variantdata[
(ref_a == "A" & alt_a == "G") |
(ref_a == "G" & alt_a == "A") |
(ref_a == "T" & alt_a == "C") |
(ref_a == "C" & alt_a == "T") ]
ti <- j@variantData[
(ref_a == "A" & alt_a == "G") |
(ref_a == "G" & alt_a == "A") |
(ref_a == "T" & alt_a == "C") |
(ref_a == "C" & alt_a == "T") ]
ti
tv <- j@variantData[
(ref_a == "A" & alt_a == "C") | (ref_a == "C" & alt_a == "A" )|
(ref_a == "T" & alt_a == "A") | (ref_a == "A" & alt_a == "T" )|
(ref_a == "G" & alt_a == "C") | (ref_a == "C" & alt_a == "G" )|
(ref_a == "T" & alt_a == "G") | (ref_a == "G" & alt_a == "T" )
]
all <- j@variantData[ref_a == "A" | ref_a =="T" | ref_a == "C" | ref_a == G]
all <- j@variantData[ref_a == "A" | ref_a =="T" | ref_a == "C" | ref_a == "G"]
617+342
length(ti)
nrows(ti)
rows(ti)
nrow(ti)
nrow(ti) / nrow(tv)
ti
unique(ti by=ch)
b <- loadVCF("../text000.vcf")
plotposition(b)
plotPosition(b)
b <- loadVCF("../text000.vcf")
b\
b
q()
